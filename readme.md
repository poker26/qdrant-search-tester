# üîç Qdrant Search Tester

–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞ –≤ Qdrant —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π **–≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞** (BGE-M3 dense + sparse).

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫** ‚Äî dense, sparse, hybrid (RRF fusion)
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–π** ‚Äî –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –∫ –¥–≤—É–º –∫–æ–ª–ª–µ–∫—Ü–∏—è–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä—è–¥–æ–º
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤** ‚Äî dense vs sparse vs hybrid –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ —á–µ—Ä–µ–∑ GUI
- **CLI —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ
git clone https://github.com/poker26/qdrant-search-tester.git
cd qdrant-search-tester
cp .env.example .env
# –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env ‚Äî —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å Qdrant –∏ BGE-M3

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∞—à–±–æ—Ä–¥
streamlit run streamlit_dashboard/test_dashboard.py
```

–ò–ª–∏ —á–µ—Ä–µ–∑ Docker:
```bash
docker compose up -d
# –î–∞—à–±–æ—Ä–¥: http://localhost:8501
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```bash
QDRANT_URL=https://your-qdrant-server.com
QDRANT_API_KEY=your-api-key
COLLECTION_NAME=distill_hybrid_v2

EMBEDDING_MODEL=bge-m3
BGE_M3_URL=http://172.17.0.1
BGE_M3_PORT=8100
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ embedding_client.py          # –ö–ª–∏–µ–Ω—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (BGE-M3 / OpenAI)
‚îú‚îÄ‚îÄ test_manager.py              # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç-–∫–µ–π—Å–∞–º–∏
‚îú‚îÄ‚îÄ tests.json                   # –¢–µ—Å—Ç—ã (–ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ)
‚îú‚îÄ‚îÄ streamlit_dashboard/
‚îÇ   ‚îî‚îÄ‚îÄ test_dashboard.py        # –û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—à–±–æ—Ä–¥
‚îú‚îÄ‚îÄ qdrant_test_scripts/
‚îÇ   ‚îú‚îÄ‚îÄ setup-qdrant.py          # –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ distill_hybrid_v2
‚îÇ   ‚îî‚îÄ‚îÄ test-runner-v2.py        # CLI —Ä–∞–Ω–Ω–µ—Ä —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ data/                        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ nginx/                       # –ö–æ–Ω—Ñ–∏–≥ nginx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yaml
‚îî‚îÄ‚îÄ .env.example
```

## –°—Ö–µ–º–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ distill_hybrid_v2

BGE-M3 –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±–∞ –≤–µ–∫—Ç–æ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞:

| –í–µ–∫—Ç–æ—Ä | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-------------|----------|
| `dense` | 1024 | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –≤–µ–∫—Ç–æ—Ä |
| `sparse` | variable | –õ–µ–∫—Å–∏—á–µ—Å–∫–∏–π –≤–µ–∫—Ç–æ—Ä (learned sparse) |

## CLI

```bash
# –°–æ–∑–¥–∞—Ç—å / –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é
python qdrant_test_scripts/setup-qdrant.py --collection distill_hybrid_v2

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å –Ω—É–ª—è
python qdrant_test_scripts/setup-qdrant.py --recreate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
python qdrant_test_scripts/test-runner-v2.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
python qdrant_test_scripts/test-runner-v2.py --tests test_anise_vodka test_ratafia
```

## –ú–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

| –ú–æ–¥–µ–ª—å | Dense dim | Sparse | –≠–Ω–¥–ø–æ–∏–Ω—Ç |
|--------|-----------|--------|----------|
| BGE-M3 | 1024 | ‚úÖ auto | `/embed/qdrant` |
| OpenAI | 1536 | ‚ùå | OpenAI API |

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
